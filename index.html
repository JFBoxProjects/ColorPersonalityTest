<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Color Personality Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#1e3a8a', // Deep blue for headers/background
            secondary: '#f3f4f6', // Light gray for backgrounds
            accent: '#6b7280', // Gray for text
            yellow: '#f59e0b', // Personality type colors
            green: '#10b981',
            red: '#ef4444',
            blue: '#3b82f6',
          },
          animation: {
            'gradient-swirl': 'gradient-swirl 3s ease infinite',
          },
          keyframes: {
            'gradient-swirl': {
              '0%, 100%': { 'background-position': '0% 50%' },
              '50%': { 'background-position': '100% 50%' },
            },
          },
        },
      },
    }
  </script>
  <style>
    .swirl-text {
      background: linear-gradient(
        45deg,
        #f59e0b,
        #10b981,
        #ef4444,
        #3b82f6,
        #f59e0b
      );
      background-size: 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradient-swirl 3s ease infinite;
    }
  </style>
</head>
<body className="bg-secondary">
  <div id="root"></div>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.10/babel.min.js"></script>
  <script type="text/babel">
    console.log("Script loaded, rendering React app...");

    const { useState, useEffect } = React;

    const questions = [
      { id: 1, prompt: "I am:", options: { yellow: "Encourager", green: "Deep thinker", red: "Doer", blue: "Listener" } },
      { id: 2, prompt: "I am:", options: { yellow: "Motivator", green: "Organizer", red: "Achiever", blue: "Mediator" } },
      { id: 3, prompt: "I am:", options: { yellow: "Charismatic", green: "Realistic", red: "Dynamic", blue: "Diplomatic" } },
      { id: 4, prompt: "I am:", options: { yellow: "Stimulating", green: "Systematic", red: "Decisive", blue: "Accommodating" } },
      { id: 5, prompt: "I am:", options: { yellow: "Spontaneous", green: "Perfectionist", red: "Risking", blue: "Accepting" } },
      { id: 6, prompt: "I am:", options: { yellow: "Cheerful", green: "Purposeful", red: "Forceful", blue: "Tactful" } },
      { id: 7, prompt: "I am:", options: { yellow: "Promoter", green: "Planner", red: "Producer", blue: "Supporter" } },
      { id: 8, prompt: "I can be:", options: { yellow: "Interrupts", green: "Critical", red: "Impatient", blue: "Indifferent" } },
      { id: 9, prompt: "I can be:", options: { yellow: "Unfocused", green: "Pessimistic", red: "Controlling", blue: "Indecisive" } },
      { id: 10, prompt: "I am:", options: { yellow: "Persuasive", green: "Diligent", red: "Competitive", blue: "Compassionate" } },
      { id: 11, prompt: "I am motivated by:", options: { yellow: "Fun & freedom", green: "Belonging & contributing", red: "Power & results", blue: "Peace & balance" } },
      { id: 12, prompt: "I like:", options: { yellow: "Variety & activity", green: "Facts, data & order", red: "Bottom line results", blue: "Low key situations" } },
      { id: 13, prompt: "I fear:", options: { yellow: "Loss of relationship", green: "Change & disorder", red: "Loss of control", blue: "Loss of harmony" } },
      { id: 14, prompt: "I need to be:", options: { yellow: "Affirmed & recognized", green: "Appreciated for my quality work", red: "Respected for my accomplishments", blue: "Accepted for who I am" } },
      { id: 15, prompt: "I am known for:", options: { yellow: "Knowing how to have a good time", green: "Doing things right", red: "Making things happen", blue: "Making people feel accepted" } },
      { id: 16, prompt: "At work I would be described as:", options: { yellow: "Outgoing & social", green: "Accurate & reliable", red: "Direct & driven", blue: "Patient & neutral" } },
      { id: 17, prompt: "I like being with people who are:", options: { yellow: "Verbally open & casual", green: "Thoughtful & do their part", red: "Competent & get their job done", blue: "Caring & kind" } },
      { id: 18, prompt: "A key part of who I am is:", options: { yellow: "My relationships with others", green: "My organization & systems", red: "My accomplishments", blue: "My stability" } },
      { id: 19, prompt: "I am frustrated by:", options: { yellow: "Routine/repetition", green: "Unpredictability", red: "Incompetence", blue: "Insensitivity" } },
      { id: 20, prompt: "Under stress I become:", options: { yellow: "Fragmented & disorganized", green: "Moody & withdrawn", red: "Dictatorial & assertive", blue: "Overwhelmed & tired" } },
    ];

    function Question({ question, rankings, setRankings }) {
      const handleRankChange = (color, value) => {
        const newRankings = { ...rankings };
        const currentQuestion = newRankings[question.id] || {};
        const prevValue = Object.keys(currentQuestion).find(key => currentQuestion[key] === parseInt(value));

        if (prevValue) {
          delete currentQuestion[prevValue];
        }

        Object.keys(currentQuestion).forEach(key => {
          if (currentQuestion[key] === parseInt(value)) {
            delete currentQuestion[key];
          }
        });

        currentQuestion[color] = parseInt(value);
        newRankings[question.id] = currentQuestion;
        setRankings(newRankings);
      };

      return (
        <div className="mb-6 p-4 border rounded-lg bg-white shadow-sm">
          <h3 className="text-lg font-semibold text-primary mb-2">{question.prompt}</h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {Object.entries(question.options).map(([color, text]) => (
              <div key={color} className="flex items-center space-x-2">
                <label className="flex-1 text-accent">{text}</label>
                <select
                  className="border rounded p-1 bg-white text-accent focus:ring-2 focus:ring-primary"
                  value={rankings[question.id]?.[color] || ""}
                  onChange={(e) => handleRankChange(color, e.target.value)}
                >
                  <option value="" disabled>Select</option>
                  {[1, 2, 3, 4].map(num => (
                    <option
                      key={num}
                      value={num}
                      disabled={Object.values(rankings[question.id] || {}).includes(num) && rankings[question.id]?.[color] !== num}
                    >
                      {num}
                    </option>
                  ))}
                </select>
              </div>
            ))}
          </div>
        </div>
      );
    }

    function Results({ rankings }) {
      const totals = { yellow: 0, green: 0, red: 0, blue: 0 };
      Object.values(rankings).forEach(question => {
        Object.entries(question).forEach(([color, rank]) => {
          totals[color] += rank;
        });
      });

      const sortedResults = Object.entries(totals)
        .map(([color, score]) => ({ color, score }))
        .sort((a, b) => b.score - a.score);

      return (
        <div className="mt-8 p-6 border rounded-lg bg-white shadow-sm">
          <h2 className="text-2xl font-bold text-primary mb-4">Your Personality Results</h2>
          <ul className="space-y-2">
            {sortedResults.map(({ color, score }) => (
              <li key={color} className="flex items-center space-x-2">
                <span className={`w-4 h-4 rounded-full bg-${color}-500`}></span>
                <span className="capitalize text-accent">{color}: {score} points</span>
              </li>
            ))}
          </ul>
        </div>
      );
    }

    function App() {
      const [rankings, setRankings] = useState({});
      const [error, setError] = useState(null);

      const allQuestionsAnswered = Object.keys(rankings).length === questions.length &&
        questions.every(q => Object.keys(rankings[q.id] || {}).length === 4);

      useEffect(() => {
        console.log("App mounted, rankings:", rankings);
      }, [rankings]);

      if (error) {
        return (
          <div className="min-h-screen bg-secondary flex items-center justify-center p-4">
            <div className="max-w-3xl w-full bg-white shadow-lg rounded-lg p-6 text-red-500">
              <h1>Error: {error}</h1>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-secondary flex flex-col items-center justify-center p-4">
          <div className="max-w-4xl w-full bg-white shadow-lg rounded-lg p-8">
            <h1 className="text-4xl font-bold text-center mb-6 swirl-text">Color Personality Test</h1>
            <div className="mb-8">
              <h2 className="text-xl font-semibold text-primary mb-2">Instructions</h2>
              <p className="text-accent">
                For each of the 20 questions below, rank the four options from 1 to 4 based on how well they describe you:
                <ul className="list-disc ml-6 mt-2">
                  <li><strong>4</strong>: Most like you</li>
                  <li><strong>3</strong>: Next most like you</li>
                  <li><strong>2</strong>: Next most like you</li>
                  <li><strong>1</strong>: Least like you</li>
                </ul>
                Each number (1, 2, 3, 4) can only be used once per question. After completing all questions, your results will show your personality type scores (Yellow, Green, Red, Blue) in ranked order.
              </p>
            </div>
            <div className="mb-8 p-4 bg-secondary rounded-lg">
              <h2 className="text-xl font-semibold text-primary mb-2">Example</h2>
              <p className="text-accent mb-2">For the question "I am:", you might rank the options as follows:</p>
              <p className="text-accent">
                DRAMATIC: <span className="font-bold text-yellow">3</span>, 
                PRECISE: <span className="font-bold text-green">1</span>, 
                POWERFUL: <span className="font-bold text-red">4</span>, 
                ACCOMMODATING: <span className="font-bold text-blue">2</span>
              </p>
            </div>
            {questions.map(question => (
              <Question
                key={question.id}
                question={question}
                rankings={rankings}
                setRankings={setRankings}
              />
            ))}
            {allQuestionsAnswered && <Results rankings={rankings} />}
          </div>
        </div>
      );
    }

    try {
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
      console.log("React app rendered successfully");
    } catch (e) {
      console.error("Error rendering React app:", e);
    }
  </script>
</body>
</html>